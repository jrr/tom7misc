default : authors.exe words.exe merge.exe

# TDM-GCC has weird problems with cerr... :/
CXX=x86_64-w64-mingw32-g++

BASE=../cc-lib/util.o ../cc-lib/base/logging.o ../cc-lib/base/stringprintf.o ../cc-lib/textsvg.o ../cc-lib/arcfour.o
CXXFLAGS=-I../cc-lib --std=c++14 -O2 -I../cc-lib/re2

RE2_OBJECTS=../cc-lib/re2/bitstate.o ../cc-lib/re2/compile.o ../cc-lib/re2/dfa.o ../cc-lib/re2/filtered_re2.o ../cc-lib/re2/mimics_pcre.o ../cc-lib/re2/nfa.o ../cc-lib/re2/onepass.o ../cc-lib/re2/parse.o ../cc-lib/re2/perl_groups.o ../cc-lib/re2/prefilter.o ../cc-lib/re2/prefilter_tree.o ../cc-lib/re2/prog.o ../cc-lib/re2/re2.o ../cc-lib/re2/regexp.o ../cc-lib/re2/set.o ../cc-lib/re2/simplify.o ../cc-lib/re2/stringpiece.o ../cc-lib/re2/tostring.o ../cc-lib/re2/unicode_casefold.o ../cc-lib/re2/unicode_groups.o ../cc-lib/re2/util/rune.o ../cc-lib/re2/util/strutil.o

AUTHORFILES=aminer_papers_0/aminer_papers_0.txt.authors aminer_papers_0/aminer_papers_1.txt.authors aminer_papers_0/aminer_papers_10.txt.authors aminer_papers_0/aminer_papers_11.txt.authors aminer_papers_0/aminer_papers_12.txt.authors aminer_papers_0/aminer_papers_13.txt.authors aminer_papers_0/aminer_papers_14.txt.authors aminer_papers_0/aminer_papers_15.txt.authors aminer_papers_0/aminer_papers_16.txt.authors aminer_papers_0/aminer_papers_17.txt.authors aminer_papers_0/aminer_papers_18.txt.authors aminer_papers_0/aminer_papers_19.txt.authors aminer_papers_0/aminer_papers_2.txt.authors aminer_papers_0/aminer_papers_20.txt.authors aminer_papers_0/aminer_papers_21.txt.authors aminer_papers_0/aminer_papers_22.txt.authors aminer_papers_0/aminer_papers_23.txt.authors aminer_papers_0/aminer_papers_24.txt.authors aminer_papers_0/aminer_papers_25.txt.authors aminer_papers_0/aminer_papers_26.txt.authors aminer_papers_0/aminer_papers_27.txt.authors aminer_papers_0/aminer_papers_28.txt.authors aminer_papers_0/aminer_papers_29.txt.authors aminer_papers_0/aminer_papers_3.txt.authors aminer_papers_0/aminer_papers_4.txt.authors aminer_papers_0/aminer_papers_5.txt.authors aminer_papers_0/aminer_papers_6.txt.authors aminer_papers_0/aminer_papers_7.txt.authors aminer_papers_0/aminer_papers_8.txt.authors aminer_papers_0/aminer_papers_9.txt.authors aminer_papers_1/aminer_papers_30.txt.authors aminer_papers_1/aminer_papers_31.txt.authors aminer_papers_1/aminer_papers_32.txt.authors aminer_papers_1/aminer_papers_33.txt.authors aminer_papers_1/aminer_papers_34.txt.authors aminer_papers_1/aminer_papers_35.txt.authors aminer_papers_1/aminer_papers_36.txt.authors aminer_papers_1/aminer_papers_37.txt.authors aminer_papers_1/aminer_papers_38.txt.authors aminer_papers_1/aminer_papers_39.txt.authors aminer_papers_1/aminer_papers_40.txt.authors aminer_papers_1/aminer_papers_41.txt.authors aminer_papers_1/aminer_papers_42.txt.authors aminer_papers_1/aminer_papers_43.txt.authors aminer_papers_1/aminer_papers_44.txt.authors aminer_papers_1/aminer_papers_45.txt.authors aminer_papers_1/aminer_papers_46.txt.authors aminer_papers_1/aminer_papers_47.txt.authors aminer_papers_1/aminer_papers_48.txt.authors aminer_papers_1/aminer_papers_49.txt.authors aminer_papers_1/aminer_papers_50.txt.authors aminer_papers_1/aminer_papers_51.txt.authors aminer_papers_1/aminer_papers_52.txt.authors aminer_papers_1/aminer_papers_53.txt.authors aminer_papers_1/aminer_papers_54.txt.authors aminer_papers_1/aminer_papers_55.txt.authors aminer_papers_1/aminer_papers_56.txt.authors aminer_papers_1/aminer_papers_57.txt.authors aminer_papers_1/aminer_papers_58.txt.authors aminer_papers_2/aminer_papers_100.txt.authors aminer_papers_2/aminer_papers_101.txt.authors aminer_papers_2/aminer_papers_102.txt.authors aminer_papers_2/aminer_papers_103.txt.authors aminer_papers_2/aminer_papers_104.txt.authors aminer_papers_2/aminer_papers_105.txt.authors aminer_papers_2/aminer_papers_106.txt.authors aminer_papers_2/aminer_papers_107.txt.authors aminer_papers_2/aminer_papers_108.txt.authors aminer_papers_2/aminer_papers_109.txt.authors aminer_papers_2/aminer_papers_110.txt.authors aminer_papers_2/aminer_papers_111.txt.authors aminer_papers_2/aminer_papers_112.txt.authors aminer_papers_2/aminer_papers_113.txt.authors aminer_papers_2/aminer_papers_114.txt.authors aminer_papers_2/aminer_papers_115.txt.authors aminer_papers_2/aminer_papers_116.txt.authors aminer_papers_2/aminer_papers_117.txt.authors aminer_papers_2/aminer_papers_118.txt.authors aminer_papers_2/aminer_papers_119.txt.authors aminer_papers_2/aminer_papers_120.txt.authors aminer_papers_2/aminer_papers_121.txt.authors aminer_papers_2/aminer_papers_122.txt.authors aminer_papers_2/aminer_papers_123.txt.authors aminer_papers_2/aminer_papers_124.txt.authors aminer_papers_2/aminer_papers_125.txt.authors aminer_papers_2/aminer_papers_126.txt.authors aminer_papers_2/aminer_papers_127.txt.authors aminer_papers_2/aminer_papers_128.txt.authors aminer_papers_2/aminer_papers_129.txt.authors aminer_papers_2/aminer_papers_130.txt.authors aminer_papers_2/aminer_papers_131.txt.authors aminer_papers_2/aminer_papers_132.txt.authors aminer_papers_2/aminer_papers_133.txt.authors aminer_papers_2/aminer_papers_134.txt.authors aminer_papers_2/aminer_papers_135.txt.authors aminer_papers_2/aminer_papers_136.txt.authors aminer_papers_2/aminer_papers_137.txt.authors aminer_papers_2/aminer_papers_138.txt.authors aminer_papers_2/aminer_papers_139.txt.authors aminer_papers_2/aminer_papers_140.txt.authors aminer_papers_2/aminer_papers_141.txt.authors aminer_papers_2/aminer_papers_142.txt.authors aminer_papers_2/aminer_papers_143.txt.authors aminer_papers_2/aminer_papers_144.txt.authors aminer_papers_2/aminer_papers_145.txt.authors aminer_papers_2/aminer_papers_146.txt.authors aminer_papers_2/aminer_papers_147.txt.authors aminer_papers_2/aminer_papers_148.txt.authors aminer_papers_2/aminer_papers_149.txt.authors aminer_papers_2/aminer_papers_150.txt.authors aminer_papers_2/aminer_papers_151.txt.authors aminer_papers_2/aminer_papers_152.txt.authors aminer_papers_2/aminer_papers_153.txt.authors aminer_papers_2/aminer_papers_154.txt.authors aminer_papers_2/aminer_papers_59.txt.authors aminer_papers_2/aminer_papers_60.txt.authors aminer_papers_2/aminer_papers_61.txt.authors aminer_papers_2/aminer_papers_62.txt.authors aminer_papers_2/aminer_papers_63.txt.authors aminer_papers_2/aminer_papers_64.txt.authors aminer_papers_2/aminer_papers_65.txt.authors aminer_papers_2/aminer_papers_66.txt.authors aminer_papers_2/aminer_papers_67.txt.authors aminer_papers_2/aminer_papers_68.txt.authors aminer_papers_2/aminer_papers_69.txt.authors aminer_papers_2/aminer_papers_70.txt.authors aminer_papers_2/aminer_papers_71.txt.authors aminer_papers_2/aminer_papers_72.txt.authors aminer_papers_2/aminer_papers_73.txt.authors aminer_papers_2/aminer_papers_74.txt.authors aminer_papers_2/aminer_papers_75.txt.authors aminer_papers_2/aminer_papers_76.txt.authors aminer_papers_2/aminer_papers_77.txt.authors aminer_papers_2/aminer_papers_78.txt.authors aminer_papers_2/aminer_papers_79.txt.authors aminer_papers_2/aminer_papers_80.txt.authors aminer_papers_2/aminer_papers_81.txt.authors aminer_papers_2/aminer_papers_82.txt.authors aminer_papers_2/aminer_papers_83.txt.authors aminer_papers_2/aminer_papers_84.txt.authors aminer_papers_2/aminer_papers_85.txt.authors aminer_papers_2/aminer_papers_86.txt.authors aminer_papers_2/aminer_papers_87.txt.authors aminer_papers_2/aminer_papers_88.txt.authors aminer_papers_2/aminer_papers_89.txt.authors aminer_papers_2/aminer_papers_90.txt.authors aminer_papers_2/aminer_papers_91.txt.authors aminer_papers_2/aminer_papers_92.txt.authors aminer_papers_2/aminer_papers_93.txt.authors aminer_papers_2/aminer_papers_94.txt.authors aminer_papers_2/aminer_papers_95.txt.authors aminer_papers_2/aminer_papers_96.txt.authors aminer_papers_2/aminer_papers_97.txt.authors aminer_papers_2/aminer_papers_98.txt.authors aminer_papers_2/aminer_papers_99.txt.authors

WORDFILES=aminer_papers_0/aminer_papers_0.txt.words aminer_papers_0/aminer_papers_1.txt.words aminer_papers_0/aminer_papers_10.txt.words aminer_papers_0/aminer_papers_11.txt.words aminer_papers_0/aminer_papers_12.txt.words aminer_papers_0/aminer_papers_13.txt.words aminer_papers_0/aminer_papers_14.txt.words aminer_papers_0/aminer_papers_15.txt.words aminer_papers_0/aminer_papers_16.txt.words aminer_papers_0/aminer_papers_17.txt.words aminer_papers_0/aminer_papers_18.txt.words aminer_papers_0/aminer_papers_19.txt.words aminer_papers_0/aminer_papers_2.txt.words aminer_papers_0/aminer_papers_20.txt.words aminer_papers_0/aminer_papers_21.txt.words aminer_papers_0/aminer_papers_22.txt.words aminer_papers_0/aminer_papers_23.txt.words aminer_papers_0/aminer_papers_24.txt.words aminer_papers_0/aminer_papers_25.txt.words aminer_papers_0/aminer_papers_26.txt.words aminer_papers_0/aminer_papers_27.txt.words aminer_papers_0/aminer_papers_28.txt.words aminer_papers_0/aminer_papers_29.txt.words aminer_papers_0/aminer_papers_3.txt.words aminer_papers_0/aminer_papers_4.txt.words aminer_papers_0/aminer_papers_5.txt.words aminer_papers_0/aminer_papers_6.txt.words aminer_papers_0/aminer_papers_7.txt.words aminer_papers_0/aminer_papers_8.txt.words aminer_papers_0/aminer_papers_9.txt.words aminer_papers_1/aminer_papers_30.txt.words aminer_papers_1/aminer_papers_31.txt.words aminer_papers_1/aminer_papers_32.txt.words aminer_papers_1/aminer_papers_33.txt.words aminer_papers_1/aminer_papers_34.txt.words aminer_papers_1/aminer_papers_35.txt.words aminer_papers_1/aminer_papers_36.txt.words aminer_papers_1/aminer_papers_37.txt.words aminer_papers_1/aminer_papers_38.txt.words aminer_papers_1/aminer_papers_39.txt.words aminer_papers_1/aminer_papers_40.txt.words aminer_papers_1/aminer_papers_41.txt.words aminer_papers_1/aminer_papers_42.txt.words aminer_papers_1/aminer_papers_43.txt.words aminer_papers_1/aminer_papers_44.txt.words aminer_papers_1/aminer_papers_45.txt.words aminer_papers_1/aminer_papers_46.txt.words aminer_papers_1/aminer_papers_47.txt.words aminer_papers_1/aminer_papers_48.txt.words aminer_papers_1/aminer_papers_49.txt.words aminer_papers_1/aminer_papers_50.txt.words aminer_papers_1/aminer_papers_51.txt.words aminer_papers_1/aminer_papers_52.txt.words aminer_papers_1/aminer_papers_53.txt.words aminer_papers_1/aminer_papers_54.txt.words aminer_papers_1/aminer_papers_55.txt.words aminer_papers_1/aminer_papers_56.txt.words aminer_papers_1/aminer_papers_57.txt.words aminer_papers_1/aminer_papers_58.txt.words aminer_papers_2/aminer_papers_100.txt.words aminer_papers_2/aminer_papers_101.txt.words aminer_papers_2/aminer_papers_102.txt.words aminer_papers_2/aminer_papers_103.txt.words aminer_papers_2/aminer_papers_104.txt.words aminer_papers_2/aminer_papers_105.txt.words aminer_papers_2/aminer_papers_106.txt.words aminer_papers_2/aminer_papers_107.txt.words aminer_papers_2/aminer_papers_108.txt.words aminer_papers_2/aminer_papers_109.txt.words aminer_papers_2/aminer_papers_110.txt.words aminer_papers_2/aminer_papers_111.txt.words aminer_papers_2/aminer_papers_112.txt.words aminer_papers_2/aminer_papers_113.txt.words aminer_papers_2/aminer_papers_114.txt.words aminer_papers_2/aminer_papers_115.txt.words aminer_papers_2/aminer_papers_116.txt.words aminer_papers_2/aminer_papers_117.txt.words aminer_papers_2/aminer_papers_118.txt.words aminer_papers_2/aminer_papers_119.txt.words aminer_papers_2/aminer_papers_120.txt.words aminer_papers_2/aminer_papers_121.txt.words aminer_papers_2/aminer_papers_122.txt.words aminer_papers_2/aminer_papers_123.txt.words aminer_papers_2/aminer_papers_124.txt.words aminer_papers_2/aminer_papers_125.txt.words aminer_papers_2/aminer_papers_126.txt.words aminer_papers_2/aminer_papers_127.txt.words aminer_papers_2/aminer_papers_128.txt.words aminer_papers_2/aminer_papers_129.txt.words aminer_papers_2/aminer_papers_130.txt.words aminer_papers_2/aminer_papers_131.txt.words aminer_papers_2/aminer_papers_132.txt.words aminer_papers_2/aminer_papers_133.txt.words aminer_papers_2/aminer_papers_134.txt.words aminer_papers_2/aminer_papers_135.txt.words aminer_papers_2/aminer_papers_136.txt.words aminer_papers_2/aminer_papers_137.txt.words aminer_papers_2/aminer_papers_138.txt.words aminer_papers_2/aminer_papers_139.txt.words aminer_papers_2/aminer_papers_140.txt.words aminer_papers_2/aminer_papers_141.txt.words aminer_papers_2/aminer_papers_142.txt.words aminer_papers_2/aminer_papers_143.txt.words aminer_papers_2/aminer_papers_144.txt.words aminer_papers_2/aminer_papers_145.txt.words aminer_papers_2/aminer_papers_146.txt.words aminer_papers_2/aminer_papers_147.txt.words aminer_papers_2/aminer_papers_148.txt.words aminer_papers_2/aminer_papers_149.txt.words aminer_papers_2/aminer_papers_150.txt.words aminer_papers_2/aminer_papers_151.txt.words aminer_papers_2/aminer_papers_152.txt.words aminer_papers_2/aminer_papers_153.txt.words aminer_papers_2/aminer_papers_154.txt.words aminer_papers_2/aminer_papers_59.txt.words aminer_papers_2/aminer_papers_60.txt.words aminer_papers_2/aminer_papers_61.txt.words aminer_papers_2/aminer_papers_62.txt.words aminer_papers_2/aminer_papers_63.txt.words aminer_papers_2/aminer_papers_64.txt.words aminer_papers_2/aminer_papers_65.txt.words aminer_papers_2/aminer_papers_66.txt.words aminer_papers_2/aminer_papers_67.txt.words aminer_papers_2/aminer_papers_68.txt.words aminer_papers_2/aminer_papers_69.txt.words aminer_papers_2/aminer_papers_70.txt.words aminer_papers_2/aminer_papers_71.txt.words aminer_papers_2/aminer_papers_72.txt.words aminer_papers_2/aminer_papers_73.txt.words aminer_papers_2/aminer_papers_74.txt.words aminer_papers_2/aminer_papers_75.txt.words aminer_papers_2/aminer_papers_76.txt.words aminer_papers_2/aminer_papers_77.txt.words aminer_papers_2/aminer_papers_78.txt.words aminer_papers_2/aminer_papers_79.txt.words aminer_papers_2/aminer_papers_80.txt.words aminer_papers_2/aminer_papers_81.txt.words aminer_papers_2/aminer_papers_82.txt.words aminer_papers_2/aminer_papers_83.txt.words aminer_papers_2/aminer_papers_84.txt.words aminer_papers_2/aminer_papers_85.txt.words aminer_papers_2/aminer_papers_86.txt.words aminer_papers_2/aminer_papers_87.txt.words aminer_papers_2/aminer_papers_88.txt.words aminer_papers_2/aminer_papers_89.txt.words aminer_papers_2/aminer_papers_90.txt.words aminer_papers_2/aminer_papers_91.txt.words aminer_papers_2/aminer_papers_92.txt.words aminer_papers_2/aminer_papers_93.txt.words aminer_papers_2/aminer_papers_94.txt.words aminer_papers_2/aminer_papers_95.txt.words aminer_papers_2/aminer_papers_96.txt.words aminer_papers_2/aminer_papers_97.txt.words aminer_papers_2/aminer_papers_98.txt.words aminer_papers_2/aminer_papers_99.txt.words

authorfiles: $(AUTHORFILES)
wordfiles: $(WORDFILES)

%.txt.authors : %.txt
	./authors.exe -o $@ $<

%.txt.words : %.txt # words.exe
	./words.exe -o $@ $<

authors.exe : authors.o $(BASE)
	${CXX} -o $@ $^ -static

words.exe : words.o $(BASE)
	${CXX} -o $@ $^ -static

merge.exe : merge.o $(BASE) $(RE2_OBJECTS)
	${CXX} -o $@ $^ -static

authorstats.exe : authorstats.o $(BASE) $(RE2_OBJECTS)
	${CXX} -o $@ $^ -static

tourney.exe : tourney.o $(BASE) $(RE2_OBJECTS)
	${CXX} -o $@ $^ -static

bestworst.exe : bestworst.o $(BASE) $(RE2_OBJECTS)
	${CXX} -o $@ $^ -static

# need forward and backward versions
authorstats.svg : authorstats.exe authors.txt
	./authorstats.exe authors.txt authorstats.svg

# and worstauthors..
bestauthors.txt : bestworst.exe authors.txt
	./bestworst.exe authors.txt bestauthors.txt worstauthors.txt mostauthors.txt

# and worstwords..
bestwords.txt : bestworst.exe words.txt
	./bestworst.exe words.txt bestwords.txt worstwords.txt mostwords.txt

wordstats.svg : authorstats.exe words.txt
	./authorstats.exe words.txt wordstats.svg

authors.txt : $(AUTHORFILES) merge.exe
	./merge.exe -o $@ $(AUTHORFILES)

words.txt : $(WORDFILES) merge.exe
	./merge.exe -o $@ $(WORDFILES)

paper.pdf : paper.tex dirham.pdf paper.bib
	pdflatex paper
	bibtex paper
	pdflatex paper

clean :
	rm -f $(BASE) $(RE2_OBJECTS) *.o *.exe *.aux *.log

